package com.wolfking.jeesite.modules.customer.md.web;

import com.google.common.collect.Lists;
import com.wolfking.jeesite.common.persistence.AjaxJsonEntity;
import com.wolfking.jeesite.modules.md.entity.Product;
import com.wolfking.jeesite.ms.providermd.service.MSCustomerProductService;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.ResponseBody;

import java.util.List;

@Controller
@RequestMapping(value="${adminPath}/customer/md/customerProduct")
public class CtCustomerProductController {
    @Autowired
    private MSCustomerProductService msCustomerProductService;

    @ResponseBody
    @RequestMapping(value = "ajax/customerProductList")
    public AjaxJsonEntity getCustomerProductList(Long customerId) {
        AjaxJsonEntity jsonEntity = new AjaxJsonEntity();
        jsonEntity.setSuccess(false);
        if (customerId != null && customerId > 1){
            List<Product> list = msCustomerProductService.findProductByCustomerIdFromCache(customerId);
            if (list == null) {
                list = Lists.newArrayList();
            }
            jsonEntity.setSuccess(true);
            jsonEntity.setData(list);
            return jsonEntity;
        }else
        {
            return jsonEntity;
        }
    }
}

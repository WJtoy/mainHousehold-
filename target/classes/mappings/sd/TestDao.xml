<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.wolfking.jeesite.modules.sd.dao.TestDao">

    <select id="findOrderConditionList" resultType="com.wolfking.jeesite.modules.sd.entity.OrderCondition">
            SELECT
                o.order_id,
                o.order_no,
                o.area_id,
                o.area_name,
                o.customer_id,
                o.user_name,
                o.phone1,
                o.phone2,
                o.phone3,
                o.address,
                o.service_address,
                o.service_phone,
                o.pending_flag,
                o.pending_type AS 'pendingType.value',
                o.pending_type_date,
                o.feedback_id,
                o.feedback_flag,
                o.feedback_date,
                o.feedback_title,
                o.reply_flag,
                o.reply_flag_kefu,
                o.reply_flag_customer,
                o.close_date,
                o.parts_flag,
                o.return_parts_flag,
                o.app_abnormaly_flag,
                o.appointment_date,
                o.operation_app_flag,
                o.grade_flag,
                o.create_by AS 'createBy.id',
                o.create_date,
                o.total_qty,
                '' AS 'createBy.name',
                o.create_date,
                o.update_by,
                o.update_date,
                o.product_ids,
                o.kefu_id,
                '' AS 'kefu.name',
                '' AS 'kefu.qq',
                '' AS 'kefu.mobile',
                o.servicepoint_id,
                o.engineer_id AS 'engineer.id',
                '' AS 'engineer.name' ,
                '' AS 'engineer.mobile',
                o.service_times,
                o.order_charge,
                o.engineer_total_charge,
                o.status AS 'status.value',
                o.service_types,
                o.charge_flag,
                o.finish_photo_qty,
                o.tracking_flag,
                o.tracking_message,
                o.tracking_date
            FROM sd_order_condition o
            LIMIT #{pageIndex},#{pageSize}
    </select>

    <!-- 批量检查时效为0的订单 -->
    <select id="batchCheckTimeliness" resultType="com.wolfking.jeesite.test.sd.OrderTimelinessInfo">
        select o.order_id, o.order_no,p.create_date as plan_date,o.arrival_date,o.close_date,o.app_complete_date,o.app_complete_type, o.time_liness
        from sd_order_condition o
        inner join sd_order_plan p
        on o.order_id = p.order_id
        and o.servicepoint_id = p.servicepoint_id
        where
            o.order_id = 1399707105791184896
        and o.quarter = '20212'
        limit 1;
    </select>

</mapper>
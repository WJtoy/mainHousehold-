<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.wolfking.jeesite.modules.sd.dao.OrderPayableDao">

	<sql id="OrderPayableColumns">
        item_no,
        form_no,
        amount,
        remark
    </sql>

	<select id="getByOrderId" resultType="OrderPayable">
		select
			<include refid="OrderPayableColumns" />
		from
			sd_order_payable
		<where>
			order_id = #{orderId}
			and quarter = #{quarter}
		</where>
		order by item_no
	</select>

	<insert id="insert">
		insert into sd_order_payable(
			order_id,
			quarter,
			item_no,
			form_no,
			amount,
			remark,
			create_by,
			create_at
		) values(
			#{orderId},
			#{quarter},
			#{itemNo},
        	#{formNo},
        	#{amount},
        	#{remark},
        	#{createBy.id},
        	#{createAt}
		)
	</insert>

	<update id="updateByItem">
		update
			sd_order_payable
		<set>
			amount = #{amount},
			<if test="formNo != null">
				form_no = #{formNo},
			</if>
			<if test="remark != null">
				remark = #{remark},
			</if>
			update_by = #{updateBy},
			update_at = #{updateAt}
		</set>
		where
			order_id = #{orderId}
			and quarter = #{quarter}
			and item_no = #{itemNo}
	</update>

	<update id="switchEnabled">
		update
			sd_order_payable
		<set>
			del_flag = #{delFlag},
			update_by = #{updateBy},
			update_at = #{updateAt}
		</set>
		where
			order_id = #{orderId}
			and item_no = #{itemNo}
			and quarter = #{quarter}
	</update>

</mapper>